---
title: LeetCode 「困难」42.接雨水
date: 2025-3-6
editLink: false
tags:
  - LeetCode
categories:
  - 算法
---

> [接雨水](https://leetcode.cn/problems/trapping-rain-water/description/)

## 题目描述

给定 `n` 个非负整数表示每个宽度为 `1` 的柱子的高度图，计算按此排列的柱子，下雨之后能接多少雨水。

**示例**

![](https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/10/22/rainwatertrap.png)

```
输入：height = [0,1,0,2,1,0,1,3,2,1,2,1]
输出：6

输入：height = [4,2,0,3,2,5]
输出：9
```

## 解答

### 暴力法

#### 关键思路

对于每个柱子，找到它左边和右边的最高柱子，然后计算当前柱子能接的雨水量。

#### 具体步骤

1. 遍历每个柱子
2. 对于每个柱子，向左遍历找到左边的最高柱子
3. 向右遍历找到右边的最高柱子
4. 当前柱子能接的雨水量为 `min(左边最高, 右边最高) - 当前柱子高度`
5. 将所有柱子的雨水量累加

::: details Code
```js
/**
 * @param {number[]} height
 * @return {number}
 */
var trap = function(height) {
  let sum = 0;

  for (let i = 0; i < height.length; ++i) {
    // 计算左边最高柱子
    let leftMaxHeight = 0;
    for (let j = 0; j <= i; ++j) {
      leftMaxHeight = Math.max(leftMaxHeight, height[j]);
    }

    // 计算右边最高柱子
    let rightMaxHeight = 0;
    for (let j = i; j < height.length; ++j) {
      rightMaxHeight = Math.max(rightMaxHeight, height[j]);
    }

    // 累加雨水量（确保不为负数）
    sum += Math.min(leftMaxHeight, rightMaxHeight) - height[i];
  }

  return sum;
};
```
:::

**Tips：为什么要包含当前柱子？**

- **接雨水的定义**：接雨水的条件是当前柱子比左右两边的最高柱子低，才能形成“凹槽”接住雨水
- **计算左边最高柱子**：如果包含当前柱子，那么 `leftMaxHeight` 表示的是从最左边到当前柱子（包括当前柱子）的最高高度
- **计算右边最高柱子**：如果包含当前柱子，那么 `rightMaxHeight` 表示的是从当前柱子（包括当前柱子）到最右边的最高高度
- **为什么包含当前柱子**：
  - 如果当前柱子本身就是左边或右边的最高柱子，那么 `Math.min(leftMaxHeight, rightMaxHeight) - height[i]` 会得到 0，表示当前柱子不能接住雨水
  - 这样可以避免错误地累加负数的雨水量

### 动态规划

::: details Code
```js
/**
 * @param {number[]} height
 * @return {number}
 */
var trap = function(height) {

};
```
:::

### 双指针

::: details Code
```js
/**
 * @param {number[]} height
 * @return {number}
 */
var trap = function(height) {

};
```
:::
