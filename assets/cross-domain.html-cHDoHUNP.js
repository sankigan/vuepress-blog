import{_ as l,c as d,e as r,a as o,d as c,b as i,r as t,o as n}from"./app-CRUSJUWc.js";const a={},p={id:"access-control-allow-credentials",tabindex:"-1"},h={class:"header-anchor",href:"#access-control-allow-credentials"},g={href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials",target:"_blank",rel:"noopener noreferrer"},u={href:"https://maomao.ink/index.php/IT/1587.html",target:"_blank",rel:"noopener noreferrer"},C={id:"script-æ ‡ç­¾çš„-crossorigin-å±æ€§",tabindex:"-1"},m={class:"header-anchor",href:"#script-æ ‡ç­¾çš„-crossorigin-å±æ€§"},T={href:"https://juejin.cn/post/6969825311361859598",target:"_blank",rel:"noopener noreferrer"};function f(k,e){const s=t("ExternalLinkIcon");return n(),d("div",null,[e[8]||(e[8]=r('<h1 id="è·¨åŸŸ" tabindex="-1"><a class="header-anchor" href="#è·¨åŸŸ"><span>è·¨åŸŸ</span></a></h1><h2 id="è·¨åŸŸæ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#è·¨åŸŸæ¦‚è¿°"><span>è·¨åŸŸæ¦‚è¿°</span></a></h2><p>å½“ä¸€ä¸ªèµ„æºä»ä¸è¯¥èµ„æºæœ¬èº«æ‰€åœ¨çš„æœåŠ¡å™¨ä¸åŒçš„ <strong><code>åŸŸã€åè®®ã€ç«¯å£</code></strong> è¯·æ±‚ä¸€ä¸ªèµ„æºæ—¶ï¼Œèµ„æºä¼šå‘èµ·ä¸€ä¸ªè·¨åŸŸ HTTP è¯·æ±‚ã€‚å‡ºäºå®‰å…¨åŸå› ï¼Œæµè§ˆå™¨é™åˆ¶ä»è„šæœ¬å†…å‘èµ·çš„è·¨æº HTTP è¯·æ±‚ï¼ŒXMLHttpRequest å’Œ Fetch APIï¼Œåªèƒ½ä»åŠ è½½åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªåŸŸè¯·æ±‚ HTTP èµ„æºï¼Œé™¤éä½¿ç”¨<code>CORSå¤´æ–‡ä»¶</code>ã€‚</p><p><strong><code>æµè§ˆå™¨é™åˆ¶</code></strong>ï¼šä¸ä¸€å®šæ˜¯æµè§ˆå™¨é™åˆ¶äº†å‘èµ·è·¨ç«™è¯·æ±‚ï¼Œä¹Ÿå¯èƒ½æ˜¯è·¨ç«™è¯·æ±‚å¯ä»¥æ­£å¸¸å‘èµ·ï¼Œä½†è¿”å›ç»“æœè¢«æµè§ˆå™¨æ‹¦æˆªã€‚</p><h2 id="cors-æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#cors-æ¦‚è¿°"><span>CORS æ¦‚è¿°</span></a></h2><p>è·¨åŸŸèµ„æºå…±äº«æ ‡å‡†æ–°å¢äº†ä¸€ç»„ HTTP é¦–éƒ¨å­—æ®µï¼Œ<strong>å…è®¸æœåŠ¡å™¨å£°æ˜å“ªäº›æºç«™é€šè¿‡æµè§ˆå™¨æœ‰æƒé™è®¿é—®å“ªäº›èµ„æº</strong>ã€‚</p><p>å¦å¤–ï¼Œè§„èŒƒè¦æ±‚ï¼Œå¯¹é‚£äº›å¯èƒ½å¯¹æœåŠ¡å™¨æ•°æ®äº§ç”Ÿå‰¯ä½œç”¨çš„ HTTP è¯·æ±‚æ–¹æ³•ï¼ˆç‰¹åˆ«æ˜¯ GET ä»¥å¤–çš„ HTTP è¯·æ±‚ï¼Œæˆ–è€…æ­é…æŸäº› MIME ç±»å‹çš„ POST è¯·æ±‚ï¼‰ï¼Œ<strong>æµè§ˆå™¨å¿…é¡»é¦–å…ˆä½¿ç”¨ OPTIONS æ–¹æ³•å‘èµ·ä¸€ä¸ª<code>é¢„æ£€è¯·æ±‚</code>ï¼ˆpreflight requestï¼‰ï¼Œä»è€Œè·çŸ¥æœåŠ¡å™¨æ˜¯å¦å…è®¸è¯¥è·¨åŸŸè¯·æ±‚ã€‚</strong></p><p><strong>æœåŠ¡å™¨ç¡®è®¤å…è®¸ä¹‹åï¼Œæ‰å‘èµ·å®é™…çš„HTTPè¯·æ±‚</strong>ã€‚ åœ¨é¢„æ£€è¯·æ±‚çš„è¿”å›ä¸­ï¼ŒæœåŠ¡å™¨ç«¯ä¹Ÿå¯ä»¥é€šçŸ¥å®¢æˆ·ç«¯ï¼Œæ˜¯å¦éœ€è¦æºå¸¦èº«ä»½å‡­è¯ï¼ˆåŒ…æ‹¬ cookie å’Œ HTTP è®¤è¯ç›¸å…³æ•°æ®ï¼‰ã€‚</p><p>è¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šå›¾ã€‚</p><p><img src="https://user-images.githubusercontent.com/25027560/50205846-accac300-03a4-11e9-8654-2d646d237820.png" alt=""></p><h3 id="ç®€å•è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#ç®€å•è¯·æ±‚"><span>ç®€å•è¯·æ±‚</span></a></h3><p>ä¸ä¼šè§¦å‘ CORS é¢„æ£€çš„è¯·æ±‚ç§°ä¸ºç®€å•è¯·æ±‚ï¼Œæ»¡è¶³ä»¥ä¸‹<strong>æ‰€æœ‰æ¡ä»¶</strong>çš„æ‰ä¼šè¢«è§†ä¸ºç®€å•è¯·æ±‚ï¼ŒåŸºæœ¬ä¸Šæ—¥å¸¸å¼€å‘åªä¼šå…³æ³¨å‰é¢ä¸¤ç‚¹ã€‚</p><ul><li>ä½¿ç”¨ <code>GET</code>ã€<code>POST</code>ã€<code>HEAD</code> å…¶ä¸­ä¸€ç§æ–¹æ³•</li><li>åªä½¿ç”¨äº†å¦‚ä¸‹çš„å®‰å…¨é¦–éƒ¨å­—æ®µï¼Œä¸å¾—äººä¸ºè®¾ç½®å…¶ä»–é¦–éƒ¨å­—æ®µ <ul><li><code>Accept</code></li><li><code>Accept-Language</code></li><li><code>Content-Language</code></li><li><code>Content-Type</code> ä»…é™ä»¥ä¸‹ä¸‰ç§ <ul><li><code>text/plain</code></li><li><code>multipart/form-data</code></li><li><code>application/x-www-form-urlencoded</code></li></ul></li><li>HTML å¤´éƒ¨ header filed å­—æ®µï¼š<code>DPR</code>ã€<code>Download</code>ã€<code>Save-Data</code>ã€<code>Viewport-Width</code>ã€<code>Width</code></li></ul></li><li>è¯·æ±‚ä¸­çš„ä»»æ„ <code>XMLHttpRequestUpload</code> å¯¹è±¡å‡æ²¡æœ‰æ³¨å†Œä»»ä½•äº‹ä»¶ç›‘å¬å™¨ï¼›<code>XMLHttpRequestUpload</code>å¯¹è±¡å¯ä»¥ä½¿ç”¨ <code>XMLHttpRequest.upload</code> å±æ€§è®¿é—®</li><li>è¯·æ±‚ä¸­æ²¡æœ‰ä½¿ç”¨ <code>ReadableStream</code> å¯¹è±¡</li></ul><h3 id="é¢„æ£€è¯·æ±‚" tabindex="-1"><a class="header-anchor" href="#é¢„æ£€è¯·æ±‚"><span>é¢„æ£€è¯·æ±‚</span></a></h3><p>éœ€é¢„æ£€çš„è¯·æ±‚è¦æ±‚å¿…é¡»ä½¿ç”¨ OPTIONS æ–¹æ³•å‘èµ·ä¸€ä¸ªé¢„æ£€è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼Œä»¥è·çŸ¥æœåŠ¡å™¨æ˜¯å¦å…è®¸è¯¥å®é™…è¯·æ±‚ã€‚<code>é¢„æ£€è¯·æ±‚</code> çš„ä½¿ç”¨ï¼Œå¯ä»¥é¿å…è·¨åŸŸè¯·æ±‚å¯¹æœåŠ¡å™¨çš„ç”¨æˆ·æ•°æ®äº§ç”Ÿæœªé¢„æœŸçš„å½±å“ã€‚</p><p>ä¸‹é¢çš„è¯·æ±‚ä¼šè§¦å‘é¢„æ£€è¯·æ±‚ï¼Œå…¶å®<strong>éç®€å•è¯·æ±‚ä¹‹å¤–çš„éƒ½ä¼šè§¦å‘é¢„æ£€</strong></p><ul><li>ä½¿ç”¨ <code>PUT</code>ã€<code>DELETE</code>ã€<code>CONNECT</code>ã€<code>OPTIONS</code>ã€<code>TRACE</code>ã€<code>PATCH</code> æ–¹æ³•</li><li>äººä¸ºè®¾ç½®äº†éè§„å®šå†…çš„å…¶ä»–é¦–éƒ¨å­—æ®µï¼Œå‚è€ƒä¸Šé¢ç®€å•è¯·æ±‚çš„å®‰å…¨å­—æ®µé›†åˆï¼Œè¿˜è¦ç‰¹åˆ«æ³¨æ„ <code>Content-Type</code> çš„ç±»å‹</li><li><code>XMLHttpRequestUpload</code> å¯¹è±¡æ³¨å†Œäº†ä»»ä½•äº‹ä»¶ç›‘å¬å™¨</li><li>è¯·æ±‚ä¸­ä½¿ç”¨äº† <code>ReadableStream</code> å¯¹è±¡</li></ul><h3 id="è¯·æ±‚é™„å¸¦èº«ä»½å‡­è¯-cookie" tabindex="-1"><a class="header-anchor" href="#è¯·æ±‚é™„å¸¦èº«ä»½å‡­è¯-cookie"><span>è¯·æ±‚é™„å¸¦èº«ä»½å‡­è¯ =&gt; cookie</span></a></h3><p>å¦‚æœå‘èµ·è¯·æ±‚æ—¶è®¾ç½® <code>WithCredentials</code> æ ‡å¿—è®¾ç½®ä¸º <code>true</code>ï¼Œä»è€Œå‘æœåŠ¡å™¨å‘é€ <code>cookie</code>ï¼Œä½†æ˜¯å¦‚æœæœåŠ¡å™¨çš„å“åº”ä¸­æœªæºå¸¦ <code>Access-Control-Allow-Credentials: true</code>ï¼Œæµè§ˆå™¨å°†ä¸ä¼šæŠŠå“åº”å†…å®¹è¿”å›ç»™è¯·æ±‚çš„å‘é€è€…ã€‚</p><p>å¯¹äºé™„å¸¦èº«ä»½å‡­è¯çš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨ä¸å¾—è®¾ç½® <code>Access-Control-Allow-Origin</code> çš„å€¼ä¸º<code>*</code>ï¼Œå¿…é¡»æ˜¯æŸä¸ªå…·ä½“çš„åŸŸåã€‚</p><p>æ³¨æ„ï¼Œç®€å• GET è¯·æ±‚ä¸ä¼šè¢«é¢„æ£€ï¼›å¦‚æœæ­¤ç±»å¸¦æœ‰èº«ä»½å‡­è¯è¯·æ±‚çš„å“åº”ä¸­ä¸åŒ…å«è¯¥å­—æ®µï¼Œè¿™ä¸ªå“åº”å°†è¢«å¿½ç•¥æ‰ï¼Œå¹¶ä¸”æµè§ˆå™¨ä¹Ÿä¸ä¼šå°†ç›¸åº”å†…å®¹è¿”å›ç»™ç½‘é¡µã€‚</p><h2 id="å®Œæ•´è¯·æ±‚æµç¨‹" tabindex="-1"><a class="header-anchor" href="#å®Œæ•´è¯·æ±‚æµç¨‹"><span>å®Œæ•´è¯·æ±‚æµç¨‹</span></a></h2><p><img src="https://user-images.githubusercontent.com/25027560/50205881-c409b080-03a4-11e9-8a57-a2a6d0e1d879.png" alt=""></p><h2 id="cors" tabindex="-1"><a class="header-anchor" href="#cors"><span>CORS</span></a></h2>',24)),o("h3",p,[o("a",h,[o("span",null,[o("a",g,[e[0]||(e[0]=c("Access-Control-Allow-Credentials")),i(s)])])])]),e[9]||(e[9]=r('<p><code>Access-Control-Allow-Credentials</code> å“åº”å¤´ç”¨äºåœ¨è¯·æ±‚è¦æ±‚åŒ…å« credentials æ—¶ï¼Œå‘ŠçŸ¥æµè§ˆå™¨æ˜¯å¦å¯ä»¥å°†å¯¹è¯·æ±‚çš„å“åº”æš´éœ²ç»™å‰ç«¯ JS ä»£ç ã€‚</p><p>å½“è¯·æ±‚çš„ credentials æ¨¡å¼ä¸º include æ—¶ï¼Œæµè§ˆå™¨ä»…åœ¨å“åº”æ ‡å¤´ <code>Access-Control-Allow-Credentials</code> çš„å€¼ä¸º true çš„æƒ…å†µä¸‹å°†å“åº”æš´éœ²ç»™å‰ç«¯çš„ JS ä»£ç ã€‚</p><p>Credentials å¯ä»¥æ˜¯ cookiesã€authorization headers æˆ– TLS client certificatesã€‚</p><p>å½“ä½œä¸ºé¢„æ£€è¯·æ±‚çš„å“åº”çš„ä¸€éƒ¨åˆ†æ—¶ï¼Œè¿™èƒ½è¡¨ç¤ºæ˜¯å¦çœŸæ­£çš„è¯·æ±‚å¯ä»¥ä½¿ç”¨ credentialsã€‚<strong>æ³¨æ„ç®€å•çš„ GET è¯·æ±‚æ²¡æœ‰é¢„æ£€ï¼Œæ‰€ä»¥è‹¥ä¸€ä¸ªå¯¹èµ„æºçš„è¯·æ±‚ä»£ç† credentialsï¼Œå¦‚æœè¿™ä¸ªå“åº”å¤´æ²¡æœ‰éšèµ„æºè¿”å›ï¼Œå“åº”å°±ä¼šè¢«æµè§ˆå™¨å¿½è§†ï¼Œä¸ä¼šè¿”å›åˆ° web å†…å®¹ã€‚</strong></p><p><code>Access-Control-Allow-Credentials</code> æ ‡å¤´éœ€è¦ä¸ <code>XMLHttpRequest.withCredentials</code> æˆ– Fetch API çš„ <code>Request()</code> æ„é€ å‡½æ•°ä¸­çš„ <code>credentials</code> é€‰é¡¹ç»“åˆä½¿ç”¨ã€‚Credentials å¿…é¡»åœ¨å‰åç«¯éƒ½è¢«é…ç½®ï¼ˆå³ <code>Access-Control-Allow-Credentials</code> header å’Œ XHR æˆ– Fetch requeset ä¸­éƒ½è¦é…ç½®ï¼‰æ‰èƒ½ä½¿å¸¦ credentials çš„ CORS è¯·æ±‚æˆåŠŸã€‚</p><h4 id="tips" tabindex="-1"><a class="header-anchor" href="#tips"><span>tips</span></a></h4>',6)),o("ol",null,[o("li",null,[o("a",u,[e[1]||(e[1]=c("ğŸ”—")),i(s)]),e[2]||(e[2]=c(" å¦‚æœæœåŠ¡å™¨ç«¯å¼€å¯äº† Access-Control-Allow-Credentials ä¸º trueï¼Œå‡è®¾æœåŠ¡å™¨ç«¯è®¾ç½®äº† Access-Control-Allow-Origin ä¸º *ï¼Œæ„å‘³ç€å°† cookie å¼€æ”¾ç»™äº†æ‰€æœ‰ç½‘ç«™ã€‚å¦‚æœæœåŠ¡ç«¯è®¾ç½®äº† ")),e[3]||(e[3]=o("code",null,'"Access-Control-Allow-Origin": "*"',-1)),e[4]||(e[4]=c("ï¼Œå®¢æˆ·ç«¯è¯·æ±‚æ—¶æ— éœ€å†è®¾ç½® ")),e[5]||(e[5]=o("code",null,"withCredentials: true",-1)),e[6]||(e[6]=c("ã€‚"))])]),o("h3",C,[o("a",m,[o("span",null,[o("a",T,[e[7]||(e[7]=c("script æ ‡ç­¾çš„ crossorigin å±æ€§")),i(s)])])])]),e[10]||(e[10]=r('<h4 id="script-æ ‡ç­¾è¯·æ±‚èµ„æº" tabindex="-1"><a class="header-anchor" href="#script-æ ‡ç­¾è¯·æ±‚èµ„æº"><span>script æ ‡ç­¾è¯·æ±‚èµ„æº</span></a></h4><ol><li>script æ ‡ç­¾è¯·æ±‚èµ„æºçš„æ—¶å€™ï¼Œrequest æ˜¯æ²¡æœ‰ origin å¤´çš„ã€‚</li><li>script æ ‡ç­¾è¯·æ±‚è·¨åŸŸèµ„æºçš„æ—¶å€™ï¼Œå†…éƒ¨è¿è¡Œå¦‚æœæŠ¥é”™çš„è¯ï¼Œ<code>window.onerror</code> æ•è·çš„æ—¶å€™ï¼Œå†…éƒ¨çš„ <code>error.message</code> åªèƒ½çœ‹åˆ° <code>Script error</code>ï¼Œçœ‹ä¸åˆ°å®Œæ•´çš„é”™è¯¯å†…å®¹ã€‚</li></ol><h4 id="script-æ ‡ç­¾-crossorigin-å±æ€§" tabindex="-1"><a class="header-anchor" href="#script-æ ‡ç­¾-crossorigin-å±æ€§"><span>script æ ‡ç­¾ crossorigin å±æ€§</span></a></h4><ol><li>è®¾ç½® <code>crossorigin</code> å±æ€§åï¼Œ<code>script</code> æ ‡ç­¾å»è¯·æ±‚èµ„æºçš„æ—¶å€™ï¼Œrequest ä¼šå¸¦ä¸Š origin å¤´ï¼Œç„¶åä¼šè¦æ±‚æœåŠ¡å™¨è¿›è¡Œ cors æ ¡éªŒï¼Œè·¨åŸŸçš„æ—¶å€™å¦‚æœ response header æ²¡æœ‰ <code>Access-Control-Allow-Origin</code> æ˜¯ä¸ä¼šæ‹¿åˆ°èµ„æºçš„ã€‚cors éªŒè¯é€šè¿‡åï¼Œæ‹¿åˆ°çš„ script è¿è¡Œå†…éƒ¨æŠ¥é”™çš„è¯ï¼Œ<code>window.onerror</code> æ•è·çš„æ—¶å€™ï¼Œå†…éƒ¨çš„ <code>error.message</code> å¯ä»¥çœ‹åˆ°å®Œæ•´çš„é”™è¯¯ä¿¡æ¯ã€‚</li><li><code>crossorigin</code> çš„å±æ€§å€¼åˆ†ä¸º <code>anonymous</code> å’Œ <code>use-credentials</code>ã€‚å¦‚æœè®¾ç½®äº† <code>crossorigin</code> å±æ€§ï¼Œä½†æ˜¯å±æ€§å€¼ä¸æ­£ç¡®çš„è¯ï¼Œé»˜è®¤æ˜¯ <code>anonymous</code>ã€‚</li><li><code>anonymous</code> ä»£è¡¨åŒåŸŸä¼šå¸¦ä¸Š cookieï¼Œè·¨åŸŸåˆ™ä¸å¸¦ä¸Š cookieï¼Œç›¸å½“äº fetch è¯·æ±‚çš„ <code>credentials: &#39;same-origin&#39;</code>ã€‚</li><li><code>use-credentials</code> è·¨åŸŸä¹Ÿä¼šå¸¦ä¸Š cookieï¼Œç›¸å½“äº fetch è¯·æ±‚çš„ <code>credentials: &#39;include&#39;</code>ï¼Œè¿™ç§æƒ…å†µä¸‹è·¨åŸŸçš„ response header éœ€è¦è®¾ç½® <code>&#39;Access-Control-Allow-Credentials&#39; = true</code>ï¼Œå¦åˆ™ cors å¤±è´¥ã€‚</li></ol><h4 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“"><span>æ€»ç»“</span></a></h4><ol><li>è®¾ç½®äº† <code>crossorigin</code> å±æ€§å°±ç›¸å½“äºå¼€å¯äº† cors æ ¡éªŒã€‚</li><li>å¼€å¯ cors æ ¡éªŒä¹‹åï¼Œè·¨åŸŸçš„ script èµ„æºåœ¨è¿è¡Œå‡ºé”™çš„æ—¶å€™ï¼Œ<code>window.onerror</code> å¯ä»¥æ•è·åˆ°å®Œæ•´çš„é”™è¯¯ä¿¡æ¯ã€‚</li><li><code>crossorigin=use-credentials</code> å¯ä»¥è·¨åŸŸå¸¦ä¸Š cookieã€‚</li></ol>',6))])}const A=l(a,[["render",f],["__file","cross-domain.html.vue"]]),b=JSON.parse('{"path":"/blogs/network-browser/cross-domain.html","title":"è·¨åŸŸ","lang":"zh-CN","frontmatter":{"title":"è·¨åŸŸ","date":"2019-3-22","editLink":false,"tags":["ç½‘ç»œä¸æµè§ˆå™¨"],"categories":["å‰ç«¯"]},"headers":[{"level":2,"title":"è·¨åŸŸæ¦‚è¿°","slug":"è·¨åŸŸæ¦‚è¿°","link":"#è·¨åŸŸæ¦‚è¿°","children":[]},{"level":2,"title":"CORS æ¦‚è¿°","slug":"cors-æ¦‚è¿°","link":"#cors-æ¦‚è¿°","children":[{"level":3,"title":"ç®€å•è¯·æ±‚","slug":"ç®€å•è¯·æ±‚","link":"#ç®€å•è¯·æ±‚","children":[]},{"level":3,"title":"é¢„æ£€è¯·æ±‚","slug":"é¢„æ£€è¯·æ±‚","link":"#é¢„æ£€è¯·æ±‚","children":[]},{"level":3,"title":"è¯·æ±‚é™„å¸¦èº«ä»½å‡­è¯ => cookie","slug":"è¯·æ±‚é™„å¸¦èº«ä»½å‡­è¯-cookie","link":"#è¯·æ±‚é™„å¸¦èº«ä»½å‡­è¯-cookie","children":[]}]},{"level":2,"title":"å®Œæ•´è¯·æ±‚æµç¨‹","slug":"å®Œæ•´è¯·æ±‚æµç¨‹","link":"#å®Œæ•´è¯·æ±‚æµç¨‹","children":[]},{"level":2,"title":"CORS","slug":"cors","link":"#cors","children":[{"level":3,"title":"Access-Control-Allow-Credentials","slug":"access-control-allow-credentials","link":"#access-control-allow-credentials","children":[]},{"level":3,"title":"script æ ‡ç­¾çš„ crossorigin å±æ€§","slug":"script-æ ‡ç­¾çš„-crossorigin-å±æ€§","link":"#script-æ ‡ç­¾çš„-crossorigin-å±æ€§","children":[]}]}],"git":{"createdTime":1739535625000,"updatedTime":1739535625000,"contributors":[{"name":"sankigan","email":"sankigan@tencent.com","commits":1}]},"filePathRelative":"blogs/network-browser/cross-domain.md"}');export{A as comp,b as data};
